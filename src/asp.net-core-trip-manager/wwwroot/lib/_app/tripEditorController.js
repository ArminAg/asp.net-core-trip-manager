!function(){"use strict";function e(e,o,i){var s=this;s.tripName=e.tripName,s.stops=[],s.isBusy=!0,s.newStop={};var l="/api/trips/"+s.tripName+"/stops";$(".page-title").text(s.tripName),o.get(l).then(function(e){angular.copy(e.data,s.stops),t(s.stops)},function(e){Materialize.toast("Failed to load Stops",3e3)}).finally(function(){s.isBusy=!1}),s.addStop=function(){s.isBusy=!0,o.post(l,s.newStop).then(function(e){s.stops.push(e.data),s.newStop={},i.newStopForm.$setUntouched(),i.newStopForm.$setPristine(),t(s.stops)},function(){Materialize.toast("Failed to add new Stop",3e3)}).finally(function(){s.isBusy=!1})},s.deleteStop=function(e){s.isBusy=!0,o.delete(l+"/"+e.id).then(function(){var o=s.stops.indexOf(e);s.stops.splice(o,1),t(s.stops)},function(){Materialize.toast("Failed to delete Stop",3e3)}).finally(function(){s.isBusy=!1})}}function t(e){if(e&&e.length>0){var t=_.map(e,function(e){return{lat:e.latitude,long:e.longitude,info:e.name}});travelMap.createMap({stops:t,selector:"#map",currentStop:e.length-1,initialZoom:11,icon:{url:"../img/map-pin.png",width:3,height:3},pastStroke:{color:"#34495e",opacity:.5,weight:2},futureStroke:{color:"#34495e",opacity:.6,weight:2},mapOptions:{styles:[{featureType:"all",elementType:"geometry",stylers:[{lightness:"40"}]},{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#92c83e"},{lightness:"70"},{saturation:"-25"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#d2d2d2"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#bebebe"},{visibility:"off"}]},{featureType:"road.highway.controlled_access",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#b9b9b9"}]},{featureType:"road.highway.controlled_access",elementType:"geometry.stroke",stylers:[{color:"#d2d2d2"},{visibility:"on"}]},{featureType:"water",elementType:"all",stylers:[{color:"#46acb9"},{lightness:"65"},{saturation:"-15"}]}]}})}}e.$inject=["$routeParams","$http","$scope"],angular.module("app-trips").controller("tripEditorController",e)}();